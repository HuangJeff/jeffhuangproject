<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>折線圖和直條圖範例</title>

<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.0/jquery.min.js"></script>

<!-- <script type="text/javascript" src="flot-0.8.3/jquery.min.js"></script> -->

<script type="text/javascript" src="flot-0.8.3/jquery.flot.min.js"></script>
<script type="text/javascript" src="flot-0.8.3/jquery.flot.time.js"></script>    
<script type="text/javascript" src="flot-0.8.3/jshashtable-2.1.js"></script>    
<script type="text/javascript" src="flot-0.8.3/jquery.numberformatter-1.2.3.min.js"></script>
<script type="text/javascript" src="flot-0.8.3/jquery.flot.symbol.js"></script>
<script type="text/javascript" src="flot-0.8.3/jquery.flot.axislabels.js"></script>

<script>
//******* 2014 Gold Price Chart
//temp
var data1 = [
    [gd(2014, 1, 1), 1], [gd(2014, 1, 2), -2], [gd(2014, 1, 3), -2], [gd(2014, 1, 4), 1],
    [gd(2014, 1, 5), 3], [gd(2014, 1, 6), 4], [gd(2014, 1, 7), 5], [gd(2014, 1, 8), 6],
    [gd(2014, 1, 9), 7], [gd(2014, 1, 10), 7], [gd(2014, 1, 11), 6], [gd(2014, 1, 12), 7],
    [gd(2014, 1, 13), 8], [gd(2014, 1, 14), 8], [gd(2014, 1, 15), 3], [gd(2014, 1, 16), 2],
    [gd(2014, 1, 17), 4], [gd(2014, 1, 18), -1], [gd(2014, 1, 19), 5], [gd(2014, 1, 20), 6],
    [gd(2014, 1, 21), -2], [gd(2014, 1, 22), -7], [gd(2014, 1, 23), -9], [gd(2014, 1, 24), -8],
    [gd(2014, 1, 25), -7], [gd(2014, 1, 26), -6], [gd(2014, 1, 27), -3], [gd(2014, 1, 28), 1], 
    [gd(2014, 1, 29), 6], [gd(2014, 1, 30), 9], [gd(2014, 1, 31), 8]
];
//wind
var data2 = [
    [gd(2014, 1, 1), 11], [gd(2014, 1, 2), 9], [gd(2014, 1, 3), 7], [gd(2014, 1, 4), 13],
    [gd(2014, 1, 5), 11], [gd(2014, 1, 6), 11], [gd(2014, 1, 7), 9], [gd(2014, 1, 8), 10],
    [gd(2014, 1, 9), 7], [gd(2014, 1, 10), 11], [gd(2014, 1, 11), 7], [gd(2014, 1, 12), 6],
    [gd(2014, 1, 13), 4], [gd(2014, 1, 14), 5], [gd(2014, 1, 15), 11], [gd(2014, 1, 16), 8],
    [gd(2014, 1, 17), 9], [gd(2014, 1, 18), 16], [gd(2014, 1, 19), 11], [gd(2014, 1, 20), 18],
    [gd(2014, 1, 21), 8], [gd(2014, 1, 22), 17], [gd(2014, 1, 23), 11], [gd(2014, 1, 24), 13],
    [gd(2014, 1, 25), 11], [gd(2014, 1, 26), 11], [gd(2014, 1, 27), 9], [gd(2014, 1, 28), 8],
    [gd(2014, 1, 29), 7], [gd(2014, 1, 30), 8], [gd(2014, 1, 31), 20]
];

//sea level pressure
var data3 = [
    [gd(2014, 1, 1), 1012], [gd(2014, 1, 2), 1018], [gd(2014, 1, 3), 1020], [gd(2014, 1, 4), 1016],
    [gd(2014, 1, 5), 1022], [gd(2014, 1, 6), 1023], [gd(2014, 1, 7), 1029], [gd(2014, 1, 8), 1030],
    [gd(2014, 1, 9), 1029], [gd(2014, 1, 10), 1034], [gd(2014, 1, 11), 1034], [gd(2014, 1, 12), 1023],
    [gd(2014, 1, 13), 1022], [gd(2014, 1, 14), 1026], [gd(2014, 1, 15), 1027], [gd(2014, 1, 16), 1023],
    [gd(2014, 1, 17), 1019], [gd(2014, 1, 18), 1032], [gd(2014, 1, 19), 1029], [gd(2014, 1, 20), 1017],
    [gd(2014, 1, 21), 1015], [gd(2014, 1, 22), 1017], [gd(2014, 1, 23), 1023], [gd(2014, 1, 24), 1024],
    [gd(2014, 1, 25), 1024], [gd(2014, 1, 26), 1022], [gd(2014, 1, 27), 1031], [gd(2014, 1, 28), 1023],
    [gd(2014, 1, 29), 1019], [gd(2014, 1, 30), 1008], [gd(2014, 1, 31), 993]
];


var dataset = [
    {
        label: "Sea Level Pressure",
        data: data3,         
        color: "#756600",
        bars: {
            show: true, 
            align: "center",
            barWidth: 24 * 60 * 60 * 600,
            lineWidth:1
        }
    }, {
        label: "Wind Speed",
        data: data2,
        yaxis: 2,
        color: "#0062FF",
        points: { symbol: "triangle", fillColor: "#0062FF", show: true },
        lines: {show:true}
    }, {
        label: "Temperature",
        data: data1,
        yaxis: 3,
        color: "#FF0000",
        points: { symbol: "circle", fillColor: "#FF0000", show: true },
        lines: { show: true }
    }
];

    
var options = {
    xaxis: {
        mode: "time",
        tickSize: [3, "day"],        
        tickLength: 0,
        axisLabel: "Date",
        axisLabelUseCanvas: true,
        axisLabelFontSizePixels: 12,
        axisLabelFontFamily: 'Verdana, Arial',
        axisLabelPadding: 10,
        color: "black"
    },
    yaxes: [{
            position: "left",
            max: 1070,
            color: "black",
            axisLabel: "Sea Level Pressure (hPa)",
            axisLabelUseCanvas: true,
            axisLabelFontSizePixels: 12,
            axisLabelFontFamily: 'Verdana, Arial',
            axisLabelPadding: 3            
        }, {
            position: "right",
            clolor: "black",
            axisLabel: "Wind Speed (km/hr)",
            axisLabelUseCanvas: true,
            axisLabelFontSizePixels: 12,
            axisLabelFontFamily: 'Verdana, Arial',
            axisLabelPadding: 3            
        },{
            position: "right",
            color: "black",
            axisLabel: "Temperature (°C)",
            axisLabelUseCanvas: true,
            axisLabelFontSizePixels: 12,
            axisLabelFontFamily: 'Verdana, Arial',
            axisLabelPadding: 3            
        }
    ],
    legend: {
        noColumns: 1,
        labelBoxBorderColor: "#000000",
        position: "nw"        
    },
    grid: {
        hoverable: true,
        borderWidth: 3,        
        backgroundColor: { colors: ["#ffffff", "#EDF5FF"] }
    }
};

$(document).ready(function () {
		//alert('Start...');
    $.plot($("#flot-placeholder"), dataset, options);
    $("#flot-placeholder").UseTooltip();
    //alert('End...');
});




function gd(year, month, day) {
    return new Date(year, month - 1, day).getTime();
}

var previousPoint = null, previousLabel = null;

$.fn.UseTooltip = function () {
    $(this).bind("plothover", function (event, pos, item) {
        if (item) {
            if ((previousLabel != item.series.label) || (previousPoint != item.dataIndex)) {
                previousPoint = item.dataIndex;
                previousLabel = item.series.label;
                $("#tooltip").remove();
                //console.log(item.datapoint);
                var x = item.datapoint[0];
                var y = item.datapoint[1];

                var color = item.series.color;
                var date = "Jan " + new Date(x).getDate();

                //console.log(item);
                var unit = "";

                if (item.series.label == "Sea Level Pressure") {
                    unit = "hPa";
                } else if (item.series.label == "Wind Speed") {
                    unit = "km/hr";
                } else if (item.series.label == "Temperature") {
                    unit = "°C";
                }
								
                showTooltip(item.pageX, item.pageY, color,
                            "<strong>" + item.series.label + "</strong><br>" + date +
                            " : <strong>" + y + "</strong> " + unit + "");
            }
        } else {
            $("#tooltip").remove();
            previousPoint = null;
        }
    });
};

function showTooltip(x, y, color, contents) {
    $('<div id="tooltip">' + contents + '</div>').css({
        position: 'absolute',
        display: 'none',
        top: y - 40,
        left: x - 120,
        border: '2px solid ' + color,
        padding: '3px',
        'font-size': '9px',
        'border-radius': '5px',
        'background-color': '#fff',
        'font-family': 'Verdana, Arial, Helvetica, Tahoma, sans-serif',
        opacity: 0.9
    }).appendTo("body").fadeIn(200);
}

function onloadTest() {
	//alert('123');
}

</script>

</head>
<body onload="onloadTest();">
	<div id="flot-placeholder" style="width:550px;height:300px;margin:10% auto"></div>
</body>
</html>